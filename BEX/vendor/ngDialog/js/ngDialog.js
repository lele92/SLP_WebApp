!function(e,o){"undefined"!=typeof module&&module.exports?module.exports=o(require("angular")):"function"==typeof define&&define.amd?define(["angular"],o):o(e.angular)}(this,function(e,o){"use strict";var n,a=e.module("ngDialog",[]),l=e.element,i=e.isDefined,t=(document.body||document.documentElement).style,s=i(t.animation)||i(t.WebkitAnimation)||i(t.MozAnimation)||i(t.MsAnimation)||i(t.OAnimation),c="animationend webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend",r=!1;return a.provider("ngDialog",function(){var o=this.defaults={className:"ngdialog-theme-default",plain:!1,showClose:!0,closeByDocument:!0,closeByEscape:!0,closeByNavigation:!1,appendTo:!1,preCloseCallback:!1,overlay:!0,cache:!0};this.setForceBodyReload=function(e){r=e||!1},this.setDefaults=function(n){e.extend(o,n)};var a,i=0,t=0,d={};this.$get=["$document","$templateCache","$compile","$q","$http","$rootScope","$timeout","$window","$controller",function(g,u,p,m,f,C,D,v,y){var h=g.find("body");r&&C.$on("$locationChangeSuccess",function(){h=g.find("body")});var $={onDocumentKeydown:function(e){27===e.keyCode&&b.close("$escape")},setBodyPadding:function(e){var o=parseInt(h.css("padding-right")||0,10);h.css("padding-right",o+e+"px"),h.data("ng-dialog-original-padding",o)},resetBodyPadding:function(){var e=h.data("ng-dialog-original-padding");e?h.css("padding-right",e+"px"):h.css("padding-right","")},performCloseDialog:function(e,o){var l=e.attr("id");if("undefined"!=typeof v.Hammer){var i=n.hammerTime;i.off("tap",a),i.destroy&&i.destroy(),delete n.hammerTime}else e.unbind("click");1===t&&h.unbind("keydown"),e.hasClass("ngdialog-closing")||(t-=1),C.$broadcast("ngDialog.closing",e),t=0>t?0:t,s?(n.$destroy(),e.unbind(c).bind(c,function(){e.remove(),0===t&&(h.removeClass("ngdialog-open"),$.resetBodyPadding()),C.$broadcast("ngDialog.closed",e)}).addClass("ngdialog-closing")):(n.$destroy(),e.remove(),0===t&&(h.removeClass("ngdialog-open"),$.resetBodyPadding()),C.$broadcast("ngDialog.closed",e)),d[l]&&(d[l].resolve({id:l,value:o,$dialog:e,remainingDialogs:t}),delete d[l])},closeDialog:function(o,n){var a=o.data("$ngDialogPreCloseCallback");if(a&&e.isFunction(a)){var l=a.call(o,n);e.isObject(l)?l.closePromise?l.closePromise.then(function(){$.performCloseDialog(o,n)}):l.then(function(){$.performCloseDialog(o,n)},function(){}):l!==!1&&$.performCloseDialog(o,n)}else $.performCloseDialog(o,n)}},b={open:function(s){function c(e,o){return f.get(e,o||{}).then(function(e){return e.data||""})}function r(o){return o?e.isString(o)&&k.plain?o:"boolean"!=typeof k.cache||k.cache?u.get(o)||c(o,{cache:!0}):c(o,{cache:!1}):"Empty template"}var g=this,k=e.copy(o);s=s||{},e.extend(k,s),i+=1,g.latestID="ngdialog"+i;var B;d[g.latestID]=B=m.defer(),n=e.isObject(k.scope)?k.scope.$new():C.$new();var w,S;return m.when(r(k.template||k.templateUrl)).then(function(o){if(u.put(k.template||k.templateUrl,o),k.showClose&&(o+='<div class="ngdialog-close"></div>'),g.$result=w=l('<div id="ngdialog'+i+'" class="ngdialog"></div>'),w.html(k.overlay?'<div class="ngdialog-overlay"></div><div class="ngdialog-content">'+o+"</div>":'<div class="ngdialog-content">'+o+"</div>"),k.data&&e.isString(k.data)){var s=k.data.replace(/^\s*/,"")[0];n.ngDialogData="{"===s||"["===s?e.fromJson(k.data):k.data}else k.data&&e.isObject(k.data)&&(n.ngDialogData=k.data);if(k.controller&&(e.isString(k.controller)||e.isArray(k.controller)||e.isFunction(k.controller))){var c=y(k.controller,{$scope:n,$element:w});w.data("$ngDialogControllerController",c)}if(k.className&&w.addClass(k.className),S=k.appendTo&&e.isString(k.appendTo)?e.element(document.querySelector(k.appendTo)):h,k.preCloseCallback){var r;e.isFunction(k.preCloseCallback)?r=k.preCloseCallback:e.isString(k.preCloseCallback)&&n&&(e.isFunction(n[k.preCloseCallback])?r=n[k.preCloseCallback]:n.$parent&&e.isFunction(n.$parent[k.preCloseCallback])?r=n.$parent[k.preCloseCallback]:C&&e.isFunction(C[k.preCloseCallback])&&(r=C[k.preCloseCallback])),r&&w.data("$ngDialogPreCloseCallback",r)}if(n.closeThisDialog=function(e){$.closeDialog(w,e)},D(function(){p(w)(n);var e=v.innerWidth-h.prop("clientWidth");h.addClass("ngdialog-open");var o=e-(v.innerWidth-h.prop("clientWidth"));o>0&&$.setBodyPadding(o),S.append(w),k.name?C.$broadcast("ngDialog.opened",{dialog:w,name:k.name}):C.$broadcast("ngDialog.opened",w)}),k.closeByEscape&&h.bind("keydown",$.onDocumentKeydown),k.closeByNavigation&&C.$on("$locationChangeSuccess",function(){$.closeDialog(w)}),a=function(e){var o=k.closeByDocument?l(e.target).hasClass("ngdialog-overlay"):!1,n=l(e.target).hasClass("ngdialog-close");(o||n)&&b.close(w.attr("id"),n?"$closeButton":"$document")},"undefined"!=typeof v.Hammer){var d=n.hammerTime=v.Hammer(w[0]);d.on("tap",a)}else w.bind("click",a);return t+=1,b}),{id:"ngdialog"+i,closePromise:B.promise,close:function(e){$.closeDialog(w,e)}}},openConfirm:function(o){var n=m.defer(),a={closeByEscape:!1,closeByDocument:!1};e.extend(a,o),a.scope=e.isObject(a.scope)?a.scope.$new():C.$new(),a.scope.confirm=function(e){n.resolve(e);var o=l(document.getElementById(i.id));$.performCloseDialog(o,e)};var i=b.open(a);return i.closePromise.then(function(e){return e?n.reject(e.value):n.reject()}),n.promise},close:function(e,o){var n=l(document.getElementById(e));return n.length?$.closeDialog(n,o):b.closeAll(o),b},closeAll:function(o){var n=document.querySelectorAll(".ngdialog");e.forEach(n,function(e){$.closeDialog(l(e),o)})},getDefaults:function(){return o}};return b}]}),a.directive("ngDialog",["ngDialog",function(o){return{restrict:"A",scope:{ngDialogScope:"="},link:function(n,a,l){a.on("click",function(a){a.preventDefault();var i=e.isDefined(n.ngDialogScope)?n.ngDialogScope:"noScope";e.isDefined(l.ngDialogClosePrevious)&&o.close(l.ngDialogClosePrevious);var t=o.getDefaults();o.open({template:l.ngDialog,className:l.ngDialogClass||t.className,controller:l.ngDialogController,scope:i,data:l.ngDialogData,showClose:"false"===l.ngDialogShowClose?!1:"true"===l.ngDialogShowClose?!0:t.showClose,closeByDocument:"false"===l.ngDialogCloseByDocument?!1:"true"===l.ngDialogCloseByDocument?!0:t.closeByDocument,closeByEscape:"false"===l.ngDialogCloseByEscape?!1:"true"===l.ngDialogCloseByEscape?!0:t.closeByEscape,preCloseCallback:l.ngDialogPreCloseCallback||t.preCloseCallback})})}}}]),a});